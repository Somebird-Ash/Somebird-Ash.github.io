{"meta":{"title":"Somebird的林间小仓库","subtitle":"Recording for Remembering","description":"记录成长之路","author":"Somebird","url":"http://example.com","root":"/"},"pages":[{"title":"tags","date":"2024-12-25T14:33:58.000Z","updated":"2024-12-25T14:35:29.868Z","comments":true,"path":"tags/index.html","permalink":"http://example.com/tags/index.html","excerpt":"","text":""},{"title":"categories","date":"2024-12-25T14:24:22.000Z","updated":"2024-12-25T14:32:19.490Z","comments":true,"path":"categories/index.html","permalink":"http://example.com/categories/index.html","excerpt":"","text":""}],"posts":[{"title":"2024NewStarCTF_WP_Web","slug":"2024NewStarCTF-WP-Web","date":"2024-12-28T15:18:43.000Z","updated":"2024-12-30T15:38:15.254Z","comments":true,"path":"2024/12/28/2024NewStarCTF-WP-Web/","permalink":"http://example.com/2024/12/28/2024NewStarCTF-WP-Web/","excerpt":"","text":"Week 3pangbai过家家(2) 连接进入，叫清点泄露文件 首先用dirsearch扫一下目录 发现.git文件，确定为git泄露，用Githack把泄露的文件下载下来 log和branch都没有找到后门，还有可能的就是stash(临时保存区)了 Git – Stash命令|极客教程 发现后面，用stash apply将暂存区重新应用 找到后门文件源代码，发现是一个正则表达式绕过 关键点1：非法字符转换下划线 故这里在提交payload时，NewStar_CTF.2024要写为NewStar[CTF.2024 关键点2：正则表达式首位检测绕过 preg_match默认为单行模式，如果字符串末尾是换行符，则换行符会被当做行尾而不是字符串的一部分，但是在严格不等于!&#x3D;&#x3D;中，”Welcome”和”Welcome\\n”是不等的， 所以这里构造的最终payload是 NewStar[CTF.2024&#x3D;Welcome%0a（%0a是换行符的url编码） func&#x3D;system args&#x3D;’ls &#x2F;‘ 传入发现没有回显，猜测是ls &#x2F;被过滤了或者缺少权限（？其实我也不知道为什么），因为之前的flag大部分都在环境变量里，所以这里尝试用env语句打印环境变量 得到flag","categories":[{"name":"CTF","slug":"CTF","permalink":"http://example.com/categories/CTF/"}],"tags":[{"name":"CTFwp","slug":"CTFwp","permalink":"http://example.com/tags/CTFwp/"}]}],"categories":[{"name":"CTF","slug":"CTF","permalink":"http://example.com/categories/CTF/"}],"tags":[{"name":"CTFwp","slug":"CTFwp","permalink":"http://example.com/tags/CTFwp/"}]}